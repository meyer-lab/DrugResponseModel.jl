All drugs simulated at once.
```julia; echo=false
using DrugResponseModel
using Plots

concs, populations, g1s, g2s = load(189, 1);
g0 = g1s[1,1,1]+g2s[1,1,1];
```

```julia; echo=false
# fitness, pp = optimize_hillAll(concs, g1s, g2s; maxstep=5E4)
rep1=[90.9248, 1.48422, 0.00661532, 1.71463, 0.0943887, 0.164418, 154.086, 1.25904, 1.75057, 0.148631, 0.677933, 0.842491, 45.9975, 1.24945, 1.42869, 0.850929, 0.074729, 0.303376, 3.75107, 3.25687, 0.0566983, 0.396961, 0.504343, 0.31175, 62.7498, 0.899323, 0.0525792, 0.982985, 0.0650932, 0.0844782, 1.65301, 0.635682, 0.548366, 41.6286, 21.131, 28.0472, 12.6173];

rep2 = [72.937, 1.53724, 0.00173999, 2.99428, 0.0732837, 0.0582242, 254.771, 0.863756, 1.21468, 0.372904, 0.417088, 0.674065, 15.0792, 2.21905, 0.848571, 0.975291, 0.0389797, 0.164864, 4.08181, 3.48259, 0.00349849, 2.11756, 0.368401, 0.250554, 84.485, 0.8291, 0.00061522, 0.997957, 0.0333503, 0.0206233, 1.87943, 2.7344, 0.496809, 37.4133, 76.4657, 16.6754, 9.54095];

rep3 = [249.026, 1.17626, 0.0176696, 1.92378, 0.258723, 0.250514, 72.4444, 1.60382, 1.50521, 0.00402118, 0.536743, 0.617426, 16.4157, 2.51094, 1.4205, 0.996903, 0.0347672, 0.294616, 3.49883, 8.51743, 0.00206601, 0.00949895, 0.535062, 0.400266, 93.5789, 0.895288, 0.0906962, 0.86687, 0.0549037, 0.0859144, 1.66043, 0.359569, 0.527514, 36.7245, 12.3667, 37.4321, 16.9129];

# parameters for 95.5 hours
pp = [198.616, 1.04429, 0.0386625, 2.11079, 0.172845, 0.194753, 125.853, 1.28641, 2.67474, 0.0194261, 0.57024, 0.690045, 16.9456, 2.29013, 1.85685, 0.990835, 0.0339845, 0.243558, 4.31167, 4.2881, 0.743701, 0.45077, 0.72208, 0.36916, 85.2162, 0.818204, 0.063744, 0.999612, 0.0541879, 0.0775908, 2.53385, 0.492065, 0.511441, 52.5239, 16.4035, 33.3496, 13.6045];
```

To see a smoother curve, we have divided the concentration range into 50 time points instead of 8.

```julia; echo=false
moreConcs = zeros(50,5)
for i=1:5
    moreConcs[:, i] = range(minimum(concs[:, i]),stop=maximum(concs[:, i]),length=50)
end
ps = copy(pp)
moreeffs = getODEparamsAll(ps, moreConcs);
morelapat = moreeffs[:,:,1];
moredox = moreeffs[:,:,2];
moregemc = moreeffs[:,:,3];
morepac = moreeffs[:,:,4];
morepal = moreeffs[:,:,5];
```

```julia; echo=false
effs = getODEparamsAll(pp, concs)
# each of the following are 9x8 matrices
lapat = effs[:,:,1];
dox = effs[:,:,2];
gemc = effs[:,:,3];
pac = effs[:,:,4];
pal = effs[:,:,5];
```

The following calculates the Bliss combination of the given two drugs. First, they are written in the fractional unit by subtracting them from the control condition effect (which is the same for all of the drugs), with the following formulation. Then we convert the values back to original unit.

x = drugA effect
y = drugB effect

Bliss = x + y - (x.y)

Then, we plot the concentration versus the effect alone, and when we have combination with the amount of the drugB equal to their EC50. 
In the following, we have paclitaxel alone, and when it is combined with 5 nM of gemcitabine.

```julia; echo=false
# combin = BlissCombination(morepac, moregemc,50)
# plotEffectsCombin(moreConcs, moregemc, combin)
```

The following shows the number of cells over concentration with paclitaxel alone, and with 5 nM of gemcitabine, at t = 96 hrs.

```julia; echo=false
combinedparams = fullCombinationParam(morepac, moregemc, moreeffs,50)
combination = combinedparams[:, :, 5]
plotNumcells(morepac, combination, moreConcs[:,4], g0,50)
```

### Lapatinib

```julia; echo=false
ODEplot_all(lapat, g1s[:, :, 1], g2s[:, :, 1], populations[:, :, 1], concs[:, 1])
```

```julia; echo=false
std = zeros(4,8)
plot_parameters(moreConcs[:, 1], morelapat, std)
```

```julia; echo=false
g0 = g1s[1,1,1] + g2s[1,1,1]
T = 170
plotGradient(lapat, concs[:, 1], g0, T)
```

### Doxorubicin

```julia; echo=false
ODEplot_all(dox, g1s[:, :, 2], g2s[:, :, 2], populations[:, :, 2], concs[:, 2])
```

```julia; echo=false
plot_parameters(moreConcs[:, 2], moredox, std)
```

```julia; echo=false
g0 = g1s[1, 1, 2] + g2s[1,1,2]

plotGradient(dox, concs[:, 2], g0, T)
```

### Gemcitabine

```julia; echo=false
ODEplot_all(gemc, g1s[:, :, 3], g2s[:, :, 3], populations[:, :, 3], concs[:, 3])
```

```julia; echo=false
plot_parameters(moreConcs[:, 3], moregemc, std)
```

```julia; echo=false
g0 = g1s[1, 1, 3] + g2s[1,1,3]

plotGradient(gemc, concs[:, 3], g0, T)
```

### Paclitaxel

```julia; echo=false
ODEplot_all(pac, g1s[:, :, 4], g2s[:, :, 4], populations[:, :, 4], concs[:, 4])
```

```julia; echo=false
plot_parameters(moreConcs[:, 4], morepac, std)
```

```julia; echo=false
g0 = g1s[1, 1, 4] + g2s[1,1,4]

plotGradient(pac, concs[:, 4], g0, T)
```

### Palbociclib

```julia; echo=false
ODEplot_all(pal, g1s[:, :, 5], g2s[:, :, 5], populations[:, :, 5], concs[:, 5])
```

```julia; echo=false
plot_parameters(moreConcs[:, 5], morepal, std)
```

```julia; echo=false
plotGradient(pal, concs[:, 5], g0, T)
```