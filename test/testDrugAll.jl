@testset "Fit All drug at once tests" begin
    concs, populations, g1s, g2s = load(189, 1)
    p = ones(45)

    effects = DrugResponseModel.getODEparamsAll(p, concs)
    #@time optimize_hillAll(concs, g1s, g2s; maxstep = 1E2)
    #@assert(all(x -> !isnan(x), effects))

    # TODO: Profile residHillAll

    # test the local optimization function
    initial = [131.399001020408, 1.6435671813612696, 3.0275907173462104, 2.2342379259772045, 0.33202837035970056, 0.3980475592686414, 318.0290059859216, 1.1843273174671463, 4.348428835784113, 0.9881785012508497, 1.4897526550735007, 1.9743914502590634, 14.236862789631882, 2.100808805102376, 3.0367521118439993, 1.347080536112803, 0.051161398075731494, 0.3177235145143605, 12.03626072237484, 2.1787126931493233, 3.0547294458188077, 0.9643495085287486, 2.419045074001623, 1.6304149013423437, 275.61300189526395, 0.8309557409386958, 3.0750863527484924, 2.1772776550641435, 0.32869704499179025, 0.3292348082432655, 2.0137331264569007, 0.3294416811196082, 0.5631818215020371, 49.76753274949015, 11.473801302978199, 43.257488339449154, 17.384130544042378]
    params = optim_all(concs, g1s, g2s, initial)
    @assert(all(x -> !isnan(x), params))
end
